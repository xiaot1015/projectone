<script src="__PUBLIC__/ace/assets/js/jquery-1.10.2.min.js"></script>
<div class="breadcrumbs" id="breadcrumbs">
  <script type="text/javascript">
    try {
      ace.settings.check('breadcrumbs', 'fixed')
    } catch (e) {
    }
  </script>

  <!-- <ul class="breadcrumb">
    <li>
      <i class="icon-home home-icon"></i>
      <a href="#">成绩管理</a>
    </li>
    <li class="active">靶场比赛成绩详细</li>
  </ul> --><!-- .breadcrumb -->
</div>
<!-- 弹出层 -->
<div id="keyworddiv" class="areadiv" style="display:none;border:1px solid #ccc;height:410px;width:700px;margin-left:10%;z-index:1002;position:absolute;background:#fff;">
<div style="height:380px;width:700px;overflow-y:auto;background:#fff;">
<table style="width:100%;"  name="scorede" id="scorede" border="1px">
  
</table>
</div>
<div style="text-align:center;margin-top:0px;">
      <input type="button" value="关闭" style="height:30px;width:100px;background-color:#EEE9E9;" onclick="winclose()" >
</div>
</div>
<!-- 弹出层 end-->
<div class="page-content">
  <div class="page-header">
  </div><!-- /.page-header -->

  <div class="row">
    <div class="col-xs-12">
      <!-- PAGE CONTENT BEGINS -->

      <div class="row">
        <div class="col-xs-12">
            
          <div class="table-responsive">
            <table id="tab" class="table table-striped table-bordered table-hover" >
              <thead>
                  <th>排名</th>
                  <th>名称</th>
                  <th>正确</th>
                  <th>错误</th>
                  <th>未完成</th>
                </tr>
              </thead>
              <tbody>
              <foreach name="list" item="info" key="k" >
                <tr data-id="{$info.score_id}">
                  <td>{$k+1}</td>
                  <td>{$info.user_name}</td>
                  <td>{$info.right_num}</td>
                  <td>{$info.wrong_num}</td>
                  <td>{$info.nodo_num}</td>
                </tr>
              </foreach>
              <!--tr><td align="right" colspan="5">{$page}</td></tr-->
              </tbody>
            </table>
            
          </div>
          
        </div><!-- /.col -->
    </div><!-- /.row -->
    
    <!-- PAGE CONTENT ENDS -->
  </div><!-- /.col -->
</div><!-- /.row -->
</div>

<script type="text/javascript">
var cloneItem = $('<tr><td></td><td class="isok"></td><td></td></tr>');
var tabtitle = $('<tr style="background-color:#F3F0F4;"><td>序号</td><td>回答状态</td><td>背景</td></tr>');
$("#tab").on("click","tr",function(){
	$("#scorede").empty();
	var id = $(this).attr("data-id");
	var url = "{:U('Score/gettargetscoredetailbyid')}";
	$.post(url,{id:id},function(data){

		if(data.data != null && data.status == 1 && data.data.length>0){		// 返回有数据 
			var tmps = [];
			tmps.push(tabtitle);
			$.each(data.data,function(idx,obj){
				var tmpstr = '';
				switch(obj.status){case "0":tmpstr="未完成";break;case "1":tmpstr="做对";break;case "2":tmpstr="做错";break;}
				var k_cloneitem = cloneItem.clone();
				k_cloneitem.find("td").first().text(obj.question_id);
				k_cloneitem.find("td").next(".isok").text(tmpstr).next().text(obj.question_desc);
				tmps.push(k_cloneitem);
			});
			$("#scorede").append(tmps);
		}else{
			$("#scorede").html('<tr><td>暂无数据</td></tr>');
		}
		showmark();
		$("#keyworddiv").show();
	});
});
//显示遮罩层
function showmark() {
        var bw = $(document).width();
        var bh = $(document).height();
        var e = $('<div></div>');
        e.css('background', '#000');
        e.css('width', bw + 'px');
        e.css('height', bh + 'px');
        e.css('position', 'absolute');
        e.css('left', '0');
        e.css('top', '0');
        e.css('-khtml-opacity', '0.5');
        e.css('-moz-opacity', '0.5');
        e.css('opacity', '0.5');
        e.css('filter', 'alpha(opacity=50)');
        e.css('zIndex', '1001');
        e.attr('id', 'masker');
        $(document.body).append(e);
}
    //关闭遮罩层
function winclose() {
		$("#keyworddiv").hide();
        $('#masker').remove();
}
</script>
